
{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Event Reporter application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "email"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile information. Uses path-based authorization: only the user with the matching `userId` can read/write their own document.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user. This is used to enforce path-based ownership."
            }
          ]
        }
      }
    ],
    "reasoning": "This Firestore structure prioritizes security, scalability, and debuggability, following the principles of Authorization Independence and Structural Segregation. It avoids using `get()` calls in security rules by denormalizing authorization data, enabling atomic operations and simplifying debugging. The structure clearly separates user data and uses path-based ownership where appropriate.\n\n*   **Users:** User profiles are stored in `/users/{userId}`.  This leverages path-based authorization, making rules simple (`request.auth.uid == userId`).\n\nThis structure ensures that list operations are secure because each collection will only contain documents that share the same security requirements.  Since we only have Users, the security rules for the Users collection can simply enforce authentication."
  }
}
